import{k as y,B as D}from"./index.BXL97NTB.js";import{c as m}from"./notificiation.DEfUooIU.js";import{A as g}from"./auth.module.BlJkjLy5.js";import"./index.CViUNx8d.js";const V=`${D}/api/events`,f=document.querySelector("#event-form"),n=document.querySelector("#event-name"),o=document.querySelector("#event-date"),d=document.querySelector("#event-time"),i=document.querySelector("#event-description"),b=document.querySelector("#event-portada"),E=document.querySelector("#button-create-event"),v=new Date;v.getFullYear();String(v.getMonth()+1).padStart(2,"0");String(v.getDate()).padStart(2,"0");const L=/^[a-zA-Z0-9\s.,-ñÑáéíóúÁÉÍÓÚ]+$/,S=/^\d{4}-\d{2}-\d{2}$/,I=/^\d{2}:\d{2}$/,k=/^[\w\s.,-ñÑáéíóúÁÉÍÓÚ¡!¿?()"'\/@#%\n\r]+$/,w=await g.getLoggedUser();w.id;const s={isNameValid:!1,isDateValid:!1,isTimeValid:!1,isDescriptionValid:!1};function c(e,a){a?(e.classList.remove("border-red-500","dark:border-red-500"),e.classList.add("border-green-500","dark:border-green-500")):(e.classList.remove("border-green-500","dark:border-green-500"),e.classList.add("border-red-500","dark:border-red-500")),e.value===""&&e.classList.remove("border-red-500","dark:border-red-500","border-green-500","dark:border-green-500")}function l(){const{isNameValid:e,isDateValid:a,isTimeValid:r,isDescriptionValid:t}=s;E.disabled=!e||!a||!r||!t}n.addEventListener("input",async()=>{const e=L.test(n.value);s.isNameValid=e,c(n,e),l()});o.addEventListener("input",async()=>{const e=S.test(o.value),a=new Date,r=new Date(o.value);a.setHours(0,0,0,0);const t=r>=a,u=e&&t;s.isDateValid=u,c(o,u),l()});d.addEventListener("input",async()=>{const e=I.test(d.value);s.isTimeValid=e,c(d,e),l()});i.addEventListener("input",async()=>{const e=k.test(i.value);s.isDescriptionValid=e,c(i,e),l()});f.addEventListener("submit",async e=>{e.preventDefault();try{const r=(await g.getLoggedUser()).id,t=new FormData;t.append("name",n.value),t.append("description",i.value),t.append("fecha_evento",o.value),t.append("hora_evento",d.value),t.append("usuarios_id",r),b.files[0]&&t.append("portada",b.files[0]);const u=await y.post(V,{body:t,credentials:"include"}).json();m({title:"Evento creado!",type:"success"});for(const p in s)s[p]=!1;f.reset(),[n,o,d,i].forEach(p=>{p.classList.remove("border-green-500","border-red-500")}),location.assign("/addGuest")}catch(a){console.log(a);const r=await a.response.json();m({title:"Ups! Hubo un error",description:r.error,type:"error"})}});
