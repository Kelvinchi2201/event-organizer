import{c}from"./notificiation.DEfUooIU.js";import{k as f,B as g}from"./endpoints.DkJ3glok.js";import{A as p}from"./auth.module.D43HK3_p.js";import{g as I}from"./guest.module.B9tD0Kn1.js";import"./index.CViUNx8d.js";const y=await p.getLoggedUser(),b=y.id,w=`${g}/api/events/events/${b}`,o=document.querySelector("#indications"),L=document.querySelector("#form"),i=document.querySelector("#guest-email"),n=document.querySelector("#event-id"),S=document.querySelector("#form-btn"),l=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,V=/^[\w\s.,-ñÑáéíóúÁÉÍÓÚ¡!¿?()"'\/@#%\n\r]*$/,r={isEmailValid:!1,isIndicationsValid:!0};function d(e,t){t?(e.classList.remove("border-red-500"),e.classList.add("border-green-500")):(e.classList.remove("border-green-500"),e.classList.add("border-red-500")),e.value===""&&e.classList.remove("border-red-500","border-green-500")}function m(){const e=i.value.split(/,|\s+|\n+/).filter(t=>l.test(t.trim()));r.isEmailValid=e.length>0,S.disabled=!r.isEmailValid}i.addEventListener("input",()=>{const t=i.value.split(/,|\s+|\n+/).filter(s=>s.trim()!=="").every(s=>l.test(s.trim()));d(i,t),m()});o.addEventListener("input",()=>{const e=V.test(o.value);r.isIndicationsValid=e,d(o,e)});const E=await f.get(w,{credentials:"include"}).json();E.forEach(e=>{const t=document.createElement("option");t.value=e.id,t.textContent=e.name,n.appendChild(t)});L.addEventListener("submit",async e=>{e.preventDefault();const s=i.value.trim().split(/,|\s+|\n+/).map(a=>a.trim()).filter(a=>l.test(a));if(s.length===0){c({type:"error",description:"Por favor, ingresa al menos un correo electrónico válido."});return}const u=n.options[n.selectedIndex].textContent;for(const a of s){const v={guest_name:a.split("@")[0],events_id:n.value,guest_email:a,indications:o.value||"",event_name:u};await I.addGuestTolist(v)}c({type:"success",title:`${s.length} invitado(s) agregado(s) a la lista`}),i.value="",o.value="",d(i,!1),r.isEmailValid=!1,m()});
